<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hibernate Panache :: Kube-Native Java Apps</title>
    <link rel="canonical" href="https://github.com/redhat-scholars/kube-native-java-apps/kube-native-java-apps/09-panache.html">
    <link rel="prev" href="08-quarkus-cloud-native.html">
    <link rel="next" href="10-metrics.html">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img src="../_/img/NewRHDFullLogo_4-color_white-wordmark.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="https://github.com/redhat-scholars/kube-native-java-apps">Kube-Native Java Apps</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://developers.redhat.com/ebooks/" target="_blank">Books</a>
        <a class="navbar-item" href="https://developers.redhat.com/cheatsheets/" target="_blank">Cheat Sheets</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/kubernetes-tutorial/" target="_blank">Kubernetes</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/istio-tutorial/" target="_blank">Istio</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/quarkus-tutorial/" target="_blank">Quarkus</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/knative-tutorial/" target="_blank">Knative</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/tekton-tutorial/" target="_blank">Tekton</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="kube-native-java-apps" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html"></a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="01-setup.html">Get Started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="01-setup.html#prerequisite">Prerequisites</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02-bootstrap.html">Bootstrap Quarkus App</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="02-bootstrap.html#devmode">Quarkus dev mode</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="02-bootstrap.html#continuous-testing">Quarkus Continuous Testing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="02-bootstrap.html#configuration">Configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="02-bootstrap.html#resteasy-openapi">RestEasy Jackson/OpenAPI</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="02-bootstrap.html#springboot-compat">Spring Boot migration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-kube-intro.html">Introduction to Kubernetes</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="03-kube-intro.html#sandbox">Getting your OpenShift Sandbox account</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="03-kube-intro.html#quay">Getting your Quay account</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-containers.html">Creating containers</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="04-containers.html#dockerfile">Using Dockerfile</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="04-containers.html#jib">Using Jib</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="04-containers.html#buildpacks">Using Buildpacks</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="05-kube-deployment.html">Kubernetes Deployment</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="05-kube-deployment.html#kube-extension">Kubernetes extension</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="05-kube-deployment.html#customize-resources">Customize created resources</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="06-rest-client-fault.html">Rest Client &amp; Fault Tolerance</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="06-rest-client-fault.html#rest-client">Create Rest Client</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="06-rest-client-fault.html#fault-tolerance">Fault tolerance on communication with external API</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="07-kube-advanced.html">Kubernetes Advanced</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="07-kube-advanced.html">Integration tests to avoid Kubernetes YAML issues</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="08-quarkus-cloud-native.html">Quarkus Cloud Native</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="08-quarkus-cloud-native.html#limits">Adjust Resource Limits</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="08-quarkus-cloud-native.html#health">Health check extension</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="09-panache.html">Hibernate Panache</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#panache-apps">Create Panache Applications</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-services">Dev services</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#deploy-db">Deploy Database in the sandbox</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#show-healths">Show Health Checks</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="10-metrics.html">Observability</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="10-metrics.html#micrometer">Micrometer</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="10-metrics.html#jaeger">Jaeger</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="11-serverless.html">Going Serverless</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="11-serverless.html#knative-intro">Intro to Knative</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="11-serverless.html#servelessing-service">Serverlessing a service</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="11-serverless.html#native-compile">Compile to native</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="11-serverless.html#deploy-native">Deploy</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="12-bonus-track.html">BONUS - Kafka</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="12-bonus-track.html#managed-kafka">Create a Managed Kafka instance</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="12-bonus-track.html#deploy-quarkus-sb">Deploy app in Quarkus using Kafka and Service Binding</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="12-bonus-track.html#knative-eventing">Knative Eventing</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Tutorial</a></li>
    <li><a href="09-panache.html">Hibernate Panache</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/redhat-scholars/kube-native-java-apps/edit/master/documentation/modules/ROOT/pages/09-panache.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Hibernate Panache</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>You&#8217;ll learn how easy and productive is Quarkus with Hibernate with Panache.
Let&#8217;s make our application persists TODOs into a database instead of an in-memory <code>Map</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="panache-apps"><a class="anchor" href="#panache-apps"></a>Create Panache Applications</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To start using Hibernate (with Panache), you need to add two extensions, the Hibernate-Panache and the JDBC driver of the database server.
In this specific case, we use PostgreSQL, but most of the drivers are supported.</p>
</div>
<div class="paragraph">
<p>Run the following command in the project directory:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw quarkus:add-extension -Dextensions="io.quarkus:quarkus-hibernate-orm-panache,io.quarkus:quarkus-jdbc-postgresql"</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the extension added, modify the <code>Todo.java</code> to convert it to a <code>PanacheEntity</code>:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme;

import java.util.List;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.validation.constraints.NotBlank;

import io.quarkus.hibernate.orm.panache.PanacheEntity;

@Entity <i class="conum" data-value="1"></i><b>(1)</b>
public class Todo extends PanacheEntity { <i class="conum" data-value="2"></i><b>(2)</b>

    @NotBlank <i class="conum" data-value="3"></i><b>(3)</b>
    @Column(unique = true)
    public String title;
    public boolean completed;

    @Column(name = "ordering")
    public int order;
    public String url;

    public static List&lt;Todo&gt; findNotCompleted() { <i class="conum" data-value="4"></i><b>(4)</b>
        return list("completed", false);
    }

    public static List&lt;Todo&gt; findCompleted() {
        return list("completed", true);
    }

    public static long deleteCompleted() {
        return delete("completed", true);
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Uses JPA <code>@Entity</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Makes entity a <code>PanacheEntity</code> inheriting DB operations</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Bean Validation annotation</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Implements custom operations</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Notice that we&#8217;re not providing an <code>@Id</code>, nor we&#8217;re creating the getters and setters. Don&#8217;t worry. It&#8217;s a Panache feature.
By extending PanacheEntity, we&#8217;re using the Active Record persistence pattern instead of a DAO.</p>
</div>
<div class="paragraph">
<p>This means that all persistence methods are blended with our own Entity.</p>
</div>
<div class="paragraph">
<p>Hibernate ORM is the de facto JPA implementation and offers you the full breadth of an Object Relational Mapper.
It makes complex mappings possible, but it does not make simple and common mappings trivial.
Hibernate ORM with Panache focuses on making your entities trivial and fun to write in Quarkus.</p>
</div>
<div class="paragraph">
<p>Then let&#8217;s adapt the <code>TodoResource.java</code>:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme;

import java.util.List;

import javax.transaction.Transactional;
import javax.validation.Valid;
import javax.ws.rs.DELETE;
import javax.ws.rs.GET;
import javax.ws.rs.OPTIONS;
import javax.ws.rs.PATCH;
import javax.ws.rs.POST;
import javax.ws.rs.Path;
import javax.ws.rs.PathParam;
import javax.ws.rs.WebApplicationException;
import javax.ws.rs.core.Response;
import javax.ws.rs.core.Response.Status;

import io.quarkus.panache.common.Sort;

@Path("/api")
public class TodoResource {

    @OPTIONS
    public Response opt() {
        return Response.ok().build();
    }

    @GET
    public List&lt;Todo&gt; getAll() {
        return Todo.listAll(Sort.by("order")); <i class="conum" data-value="1"></i><b>(1)</b>
    }

    @GET
    @Path("/{id}")
    public Todo getOne(@PathParam("id") Long id) {
        Todo entity = Todo.findById(id);
        if (entity == null) {
            throw new WebApplicationException("Todo with id of " + id + " does not exist.", Status.NOT_FOUND);
        }
        return entity;
    }

    @POST
    @Transactional
    public Response create(@Valid Todo item) {
        item.persist(); <i class="conum" data-value="2"></i><b>(2)</b>
        return Response.status(Status.CREATED).entity(item).build();
    }

    @PATCH
    @Path("/{id}")
    @Transactional
    public Response update(@Valid Todo todo, @PathParam("id") Long id) {
        Todo entity = Todo.findById(id);
        entity.id = id;
        entity.completed = todo.completed;
        entity.order = todo.order;
        entity.title = todo.title;
        entity.url = todo.url;
        return Response.ok(entity).build(); <i class="conum" data-value="3"></i><b>(3)</b>
    }

    @DELETE
    @Transactional
    public Response deleteCompleted() {
        Todo.deleteCompleted();
        return Response.noContent().build();
    }

    @DELETE
    @Transactional
    @Path("/{id}")
    public Response deleteOne(@PathParam("id") Long id) {
        Todo entity = Todo.findById(id);
        if (entity == null) {
            throw new WebApplicationException("Todo with id of " + id + " does not exist.", Status.NOT_FOUND);
        }
        entity.delete();
        return Response.noContent().build();
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Static method for queries</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Method for persisting data</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Update is applied automatically within a transaction</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Last thing is to configure Datasource and Hibernate.
Open <code>src/main/resources/application.properties</code>, and add the following Hibernate configuration property to create database schema automatically.</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">%dev.quarkus.hibernate-orm.database.generation=update
quarkus.hibernate-orm.database.generation=drop-and-create</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both properties are the same key, but the values are used depending on starting mode.At dev mode (<code>%dev</code>) the value used for the property is <code>update</code> while the other is used in the other cases.</p>
</div>
<div class="paragraph">
<p>Also add a property to show SQL statements executed by the application.</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">%dev.quarkus.hibernate-orm.log.sql=true</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dev-services"><a class="anchor" href="#dev-services"></a>Dev services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quarkus can even provide you with a zero-config database out of the box when testing or running in dev mode, a feature we refer to as Dev Services.
Depending on your database type, you may need Docker installed to use this feature.</p>
</div>
<div class="paragraph">
<p>To use Dev Services, all you need to do is include the relevant extension for the type of database you want (either reactive or JDBC, or both), without configuring any database URL, username, and password.</p>
</div>
<div class="paragraph">
<p>Quarkus will provide the database.
You can just start coding without worrying about config.</p>
</div>
<div class="paragraph">
<p>Before starting the application, start your local Docker/Podman/CRI-O instance, and start Quarkus app in dev-mode running the following command in the terminal:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw compile quarkus:dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output is similar to the following snippet, showing that <code>DevServiceDatasourceProcessor</code> has started a DB:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">...
[INFO] Nothing to compile - all classes are up to date
Listening for transport dt_socket at address: 5005

--
2022-04-04 13:28:23,498 INFO  [io.qua.dat.dep.dev.DevServicesDatasourceProcessor] (build-31) Dev Services for the default datasource (postgresql) started.xSocketClientProviderStr
__  ____  __  _____   ___  __ ____  ______
 --/ __ \/ / / / _ | / _ \/ //_/ / / / __/
 -/ /_/ / /_/ / __ |/ , _/ ,&lt; / /_/ /\ \
--\___\_\____/_/ |_/_/|_/_/|_|\____/___/
2022-04-04 13:28:25,903 WARN  [org.hib.eng.jdb.spi.SqlExceptionHelper] (JPA Startup Thread: &lt;default&gt;) SQL Warning Code: 0, SQLState: 00000
2022-04-04 13:28:25,904 WARN  [org.hib.eng.jdb.spi.SqlExceptionHelper] (JPA Startup Thread: &lt;default&gt;) constraint "uk_oxfuur9jdyqshux5rm7g7ga6c" of relation "todo" does not exist, skipping</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you can open the web page again in a browser (<a href="http://localhost:8080/todo.html" class="bare">http://localhost:8080/todo.html</a>) and create some TODOs.
These are inserted into database instead of a Map.
Inspect the logs to see the SQL statements.</p>
</div>
<div class="paragraph">
<p>Stop the application (<code>Ctrl+C</code>), and let&#8217;s see how to deploy the application wit the database to Kubernetes.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploy-db"><a class="anchor" href="#deploy-db"></a>Deploy Application and Database in the sandbox</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_deploy_postgresql_in_the_sandbox"><a class="anchor" href="#_deploy_postgresql_in_the_sandbox"></a>Deploy PostgreSQL in the sandbox</h3>
<div class="paragraph">
<p>Open Red Hat Sandbox console in Developers view (if not already there) and create a PostgreSQL instance by running the following steps.</p>
</div>
<div class="paragraph">
<p>Click to <strong>+Add</strong> button, scroll to Developers Catalog section, and click on <strong>Database</strong> section.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/devsandbox-DevAdd.png" alt="devsandbox DevAdd">
</div>
</div>
<div class="paragraph">
<p>Then click on the template named <strong>PostgreSQL (Ephimeral)</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/devsandbox-Postgre.png" alt="devsandbox Postgre">
</div>
</div>
<div class="paragraph">
<p>Click on <strong>Instantiate Template</strong> and fill the fields with the values shown in the following image:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/devsandbox-PostgreConf.png" alt="devsandbox PostgreConf">
</div>
</div>
<div class="paragraph">
<p>Then push the <strong>Create</strong> button and wait until the PostgreSQL instance is provided.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/devsandbox-PostgreResult.png" alt="devsandbox PostgreResult">
</div>
</div>
<div class="paragraph">
<p>Notice that a service is created with <code>postgresql</code> as name, which is the DNS name to access within the cluster to the PostgreSQL instance.</p>
</div>
<div class="paragraph">
<p>Now open again the <code>src/main/resources/application.properties</code> configuration file and configure the database parameters:</p>
</div>
<div class="listingblock console-input">
<div class="title">src/main/resources/application.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.datasource.db-kind=postgresql
quarkus.datasource.username=admin
quarkus.datasource.password=admin
quarkus.datasource.jdbc.url=jdbc:postgresql://postgresql:5432/todo</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also, let&#8217;s automate the creation of an OpenShift Route.
Copy the following content at the bottom of <code>src/main/kubernetes/kubernetes.yml</code> file:</p>
</div>
<div class="listingblock console-input">
<div class="title">src/main/kubernetes/kubernetes.yml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">---
apiVersion: route.openshift.io/v1
kind: Route
metadata:
  annotations:
    app.quarkus.io/commit-id: 72db1f18a9d063476e333b963655b4192a45e030
    app.quarkus.io/build-timestamp: 2022-04-05 - 21:26:33 +0000
  labels:
    app.kubernetes.io/version: 1.0.0-SNAPSHOT
    app.kubernetes.io/name: quarkus-app-workshop
  name: quarkus-app-workshop
spec:
  port:
    targetPort: 8080
  to:
    kind: Service
    name: quarkus-app-workshop</code></pre>
</div>
</div>
<div class="paragraph">
<p>The last step is deploying the application to sandbox by running:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw clean package -DskipTests -Dquarkus.kubernetes.deploy=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you open the sandbox console you should see both TODO application and the database deployed.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/devsandbox-deployed.png" alt="devsandbox deployed">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="show-healths"><a class="anchor" href="#show-healths"></a>Show Health Checks</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Health check extension registers a special readiness health check for databases when using Panache extension.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see how the application is become in not ready state when the database is stopped.
Open Topology view, select the PostgreSQL deployment, and go to <strong>Details</strong> tab.
There scale down the Pod to 0 instances by clicking the arrow as shown in the following figure:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/devsandbox-psql-scale-down.png" alt="devsandbox psql scale down">
</div>
</div>
<div class="paragraph">
<p>Then wait some seconds and you&#8217;ll see that the aplication becomes not ready as the readiness check fails.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/devsandbox-app-not-ready.png" alt="devsandbox app not ready">
</div>
</div>
<div class="paragraph">
<p>Scaling up the PostgreSQL instance will make the application be ready again.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="08-quarkus-cloud-native.html">Quarkus Cloud Native</a></span>
  <span class="next"><a href="10-metrics.html">Observability</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
